import{s as e,p as t}from"./index-7wJrN09q.js";import{m as n,c as r,p as i}from"./index-C5hAknqr.js";import{c as l,E as o,S as a}from"./index-CWWusv4C.js";import{p as c}from"./index-Bn4iy8CL.js";import{w as s}from"./index-DlJMGLAz.js";import{v as p}from"./index-DkGrPSvA.js";import{t as u}from"./index-Ck87fAyN.js";const h=function(e,t,n){const r=l(n);if(!e||!e.type||!e.children)throw new Error("Expected parent node");if("number"==typeof t){if(t<0||t===Number.POSITIVE_INFINITY)throw new Error("Expected positive finite number as index")}else if((t=e.children.indexOf(t))<0)throw new Error("Expected child node or index");for(;++t<e.children.length;)if(r(e.children[t],t,e))return e.children[t]},d=/\n/g,f=/[\t ]+/g,g=r("br"),m=r((function(e){return"td"===e.tagName||"th"===e.tagName})),y=r("p"),b=r("tr"),v=r(["datalist","head","noembed","noframes","noscript","rp","script","style","template","title",function(e){return Boolean((e.properties||{}).hidden)},function(e){return"dialog"===e.tagName&&!(e.properties||{}).open}]),x=r(["address","article","aside","blockquote","body","caption","center","dd","dialog","dir","dl","dt","div","figure","figcaption","footer","form,","h1","h2","h3","h4","h5","h6","header","hgroup","hr","html","legend","li","listing","main","menu","nav","ol","p","plaintext","pre","section","ul","xmp"]);function S(e,t){const n="children"in e?e.children:[],r=x(e),i=T(e,{whitespace:{}.whitespace||"normal"}),l=[];"text"!==e.type&&"comment"!==e.type||l.push(...w(e,{breakBefore:!0,breakAfter:!0}));let o=-1;for(;++o<n.length;)l.push(...k(n[o],e,{whitespace:i,breakBefore:o?void 0:r,breakAfter:o<n.length-1?g(n[o+1]):r}));const a=[];let c;for(o=-1;++o<l.length;){const e=l[o];"number"==typeof e?void 0!==c&&e>c&&(c=e):e&&(void 0!==c&&c>-1&&a.push("\n".repeat(c)||" "),c=-1,a.push(e))}return a.join("")}function k(e,t,n){return"element"===e.type?function(e,t,n){const r=T(e,n),i=e.children||[];let l,o,a=-1,c=[];if(v(e))return c;g(e)||b(e)&&h(t,e,b)?o="\n":y(e)?(l=2,o=2):x(e)&&(l=1,o=1);for(;++a<i.length;)c=c.concat(k(i[a],e,{whitespace:r,breakBefore:a?void 0:l,breakAfter:a<i.length-1?g(i[a+1]):o}));m(e)&&h(t,e,m)&&c.push("\t");l&&c.unshift(l);o&&c.push(o);return c}(e,t,n):"text"===e.type?"normal"===n.whitespace?w(e,n):function(e){return[String(e.value)]}(e):[]}function w(e,t){const n=String(e.value),r=[],i=[];let l=0;for(;l<=n.length;){d.lastIndex=l;const e=d.exec(n),i=e&&"index"in e?e.index:n.length;r.push(N(n.slice(l,i).replace(/[\u061C\u200E\u200F\u202A-\u202E\u2066-\u2069]/g,""),0!==l||t.breakBefore,i!==n.length||t.breakAfter)),l=i+1}let o,a=-1;for(;++a<r.length;)8203===r[a].charCodeAt(r[a].length-1)||a<r.length-1&&8203===r[a+1].charCodeAt(0)?(i.push(r[a]),o=void 0):r[a]?("number"==typeof o&&i.push(o),i.push(r[a]),o=0):0!==a&&a!==r.length-1||i.push(0);return i}function N(e,t,n){const r=[];let i,l=0;for(;l<e.length;){f.lastIndex=l;const n=f.exec(e);i=n?n.index:e.length,l||i||!n||t||r.push(""),l!==i&&r.push(e.slice(l,i)),l=n?i+n[0].length:i}return l===i||n||r.push(""),r.join(" ")}function T(e,t){if("element"===e.type){const n=e.properties||{};switch(e.tagName){case"listing":case"plaintext":case"xmp":return"pre";case"nobr":return"nowrap";case"pre":return n.wrap?"pre-wrap":"pre";case"td":case"th":return n.noWrap?"nowrap":t.whitespace;case"textarea":return"pre-wrap"}}return t.whitespace}function A(e){const t=String(e);let n=t.length;for(;n>0;){const e=t.codePointAt(n-1);if(void 0===e||10!==e&&13!==e)break;n--}return t.slice(0,n)}const C="language-";function I(e,t){const n=t.children;let r,i,l=-1;if("pre"===t.tagName)for(;++l<n.length;){const e=n[l];if("element"===e.type&&"code"===e.tagName&&e.properties&&e.properties.className&&Array.isArray(e.properties.className)){r=e.properties.className;break}}if(r)for(l=-1;++l<r.length;)if(String(r[l]).slice(0,9)===C){i=String(r[l]).slice(9);break}const o={type:"code",lang:i||null,meta:null,value:A(S(t))};return e.patch(t,o),o}function B(e,t){const n={type:"delete",children:e.all(t)};return e.patch(t,n),n}function j(e){let t=-1;if(e.length>1)for(;++t<e.length;)if(e[t].spread)return!0;return!1}function M(e,t){const n=e.all({type:"root",children:t}),r=e.toSpecificContent(n,U);return 0===r.length?[]:1===r.length?r[0].children:[{type:"list",ordered:!1,start:null,spread:j(r),children:r}]}function U(){return{type:"listItem",spread:!1,checked:null,children:[]}}function q(e,t){const n={type:"emphasis",children:e.all(t)};return e.patch(t,n),n}function E(e){let t=0,n=e.length;for(;t<n&&"break"===e[t].type;)t++;for(;n>t&&"break"===e[n-1].type;)n--;return 0===t&&n===e.length?e:e.slice(t,n)}function F(e,t){const n={type:"heading",depth:Number(t.tagName.charAt(1))||1,children:E(e.all(t))};return e.patch(t,n),n}function R(e,t){const n=t.properties||{},r={type:"image",url:e.resolve(String(n.src||"")||null),title:n.title?String(n.title):null,alt:n.alt?String(n.alt):""};return e.patch(t,r),r}function z(e,t){const n={type:"inlineCode",value:S(t)};return e.patch(t,n),n}function H(e,t){const n=[],r=[],i=t||e.properties||{},l=O(e),o=Math.min(Number.parseInt(String(i.size),10),0)||(i.multiple?4:1);let a=-1;for(;++a<l.length;){const e=l[a];e&&e.properties&&e.properties.selected&&n.push(e)}const c=n.length>0?n:l,s=Math.min(c.length,o);for(a=-1;++a<s;){const e=c[a],t=e.properties||{},n=S(e),i=n||String(t.label||""),l=String(t.value||"")||n;r.push([l,i===l?void 0:i])}return r}function O(e){const t=[];let n=-1;for(;++n<e.children.length;){const r=e.children[n];"children"in r&&Array.isArray(r.children)&&t.push(...O(r)),"element"!==r.type||"option"!==r.tagName||r.properties&&r.properties.disabled||t.push(r)}return t}function P(e,t){const{rest:n,checkbox:r}=L(t),i=r?Boolean(r.properties.checked):null,l={type:"listItem",spread:$(n),checked:i,children:e.toFlow(e.all(n))};return e.patch(t,l),l}function $(e){let t=-1,n=!1;for(;++t<e.children.length;){const r=e.children[t];if("element"===r.type){if(i(r))continue;if("p"===r.tagName||n||$(r))return!0;n=!0}}return!1}function L(e){const t=e.children[0];if(t&&"element"===t.type&&"input"===t.tagName&&t.properties&&("checkbox"===t.properties.type||"radio"===t.properties.type)){return{checkbox:t,rest:{...e,children:e.children.slice(1)}}}if(t&&"element"===t.type&&"p"===t.tagName){const{checkbox:n,rest:r}=L(t);if(n){return{checkbox:n,rest:{...e,children:[r,...e.children.slice(1)]}}}}return{checkbox:void 0,rest:e}}function V(e,t){const n="ol"===t.tagName,r=e.toSpecificContent(e.all(t),W);let i=null;n&&(i=t.properties&&t.properties.start?Number.parseInt(String(t.properties.start),10):1);const l={type:"list",ordered:n,start:i,spread:j(r),children:r};return e.patch(t,l),l}function W(){return{type:"listItem",spread:!1,checked:null,children:[]}}function Y(e){let t=-1;for(;++t<e.length;){const n=e[t];if(!J(n)||"children"in n&&Y(n.children))return!0}return!1}function _(e){return G(e,(function(e){return e.every((function(e){return"text"===e.type&&s(e.value)}))?[]:[{type:"paragraph",children:E(e)}]}),(function(e){return e}))}function D(e){return G(e.children,(function(t){const n=K(e);return n.children=t,[n]}),(function(t){if("children"in t&&"children"in e){const n=K(e),r=K(t);return n.children=t.children,r.children.push(n),r}return{...t}}))}function G(e,t,n){const r=function(e){const t=[];let n=-1;for(;++n<e.length;){const r=e[n];"delete"!==r.type&&"link"!==r.type||!Y(r.children)?t.push(r):t.push(...D(r))}return t}(e),i=[];let l=[],o=-1;for(;++o<r.length;){const e=r[o];J(e)?l.push(e):(l.length>0&&(i.push(...t(l)),l=[]),i.push(n(e)))}return l.length>0&&(i.push(...t(l)),l=[]),i}function J(e){const t=e.data&&e.data.hName;return t?i({type:"element",tagName:t,properties:{},children:[]}):c(e)}function K(t){return e({...t,children:[]})}function Q(e,t){const n=t.properties||{},r="video"===t.tagName?String(n.poster||""):"";let i=String(n.src||""),l=-1,a=!1,c=e.all(t);if(p({type:"root",children:c},(function(e){if("link"===e.type)return a=!0,o})),a||Y(c))return c;for(;!i&&++l<t.children.length;){const e=t.children[l];"element"===e.type&&"source"===e.tagName&&e.properties&&(i=String(e.properties.src||""))}if(r){const n={type:"image",title:null,url:e.resolve(r),alt:u(c)};e.patch(t,n),c=[n]}const s=c,h={type:"link",title:n.title?String(n.title):null,url:e.resolve(i),children:s};return e.patch(t,h),h}function X(e,t){const n=E(e.all(t));if(n.length>0){const r={type:"paragraph",children:n};return e.patch(t,r),r}}const Z=['"'];function ee(e,t){const n={type:"strong",children:e.all(t)};return e.patch(t,n),n}function te(e,t){const n={type:"tableCell",children:e.all(t)};if(e.patch(t,n),t.properties){const e=t.properties.rowSpan,r=t.properties.colSpan;if(e||r){const t=n.data||(n.data={});e&&(t.hastUtilToMdastTemporaryRowSpan=e),r&&(t.hastUtilToMdastTemporaryColSpan=r)}}return n}function ne(){return{type:"tableCell",children:[]}}function re(){return{type:"tableCell",children:[]}}function ie(){return{type:"tableRow",children:[]}}const le={comment:function(e,t){const n={type:"html",value:"\x3c!--"+t.value+"--\x3e"};return e.patch(t,n),n},doctype:se,root:function(e,t){let n=e.all(t);(e.options.document||Y(n))&&(n=_(n));const r={type:"root",children:n};return e.patch(t,r),r},text:function(e,t){const n={type:"text",value:t.value};return e.patch(t,n),n}},oe={applet:se,area:se,basefont:se,bgsound:se,caption:se,col:se,colgroup:se,command:se,content:se,datalist:se,dialog:se,element:se,embed:se,frame:se,frameset:se,isindex:se,keygen:se,link:se,math:se,menu:se,menuitem:se,meta:se,nextid:se,noembed:se,noframes:se,optgroup:se,option:se,param:se,script:se,shadow:se,source:se,spacer:se,style:se,svg:se,template:se,title:se,track:se,abbr:ae,acronym:ae,bdi:ae,bdo:ae,big:ae,blink:ae,button:ae,canvas:ae,cite:ae,data:ae,details:ae,dfn:ae,font:ae,ins:ae,label:ae,map:ae,marquee:ae,meter:ae,nobr:ae,noscript:ae,object:ae,output:ae,progress:ae,rb:ae,rbc:ae,rp:ae,rt:ae,rtc:ae,ruby:ae,slot:ae,small:ae,span:ae,sup:ae,sub:ae,tbody:ae,tfoot:ae,thead:ae,time:ae,address:ce,article:ce,aside:ce,body:ce,center:ce,div:ce,fieldset:ce,figcaption:ce,figure:ce,form:ce,footer:ce,header:ce,hgroup:ce,html:ce,legend:ce,main:ce,multicol:ce,nav:ce,picture:ce,section:ce,a:function(e,t){const n=t.properties||{},r=e.all(t),i={type:"link",url:e.resolve(String(n.href||"")||null),title:n.title?String(n.title):null,children:r};return e.patch(t,i),i},audio:Q,b:ee,base:function(e,t){e.baseFound||(e.frozenBaseUrl=String(t.properties&&t.properties.href||"")||void 0,e.baseFound=!0)},blockquote:function(e,t){const n={type:"blockquote",children:e.toFlow(e.all(t))};return e.patch(t,n),n},br:function(e,t){const n={type:"break"};return e.patch(t,n),n},code:z,dir:V,dl:function(e,t){const n=[],r=[];let i=-1;for(;++i<t.children.length;){const e=t.children[i];"element"===e.type&&"div"===e.tagName?n.push(...e.children):n.push(e)}let l={definitions:[],titles:[]};for(i=-1;++i<n.length;){const e=n[i];if("element"===e.type&&"dt"===e.tagName){const t=n[i-1];t&&"element"===t.type&&"dd"===t.tagName&&(r.push(l),l={definitions:[],titles:[]}),l.titles.push(e)}else l.definitions.push(e)}r.push(l),i=-1;const o=[];for(;++i<r.length;){const t=[...M(e,r[i].titles),...M(e,r[i].definitions)];t.length>0&&o.push({type:"listItem",spread:t.length>1,checked:null,children:t})}if(o.length>0){const n={type:"list",ordered:!1,start:null,spread:j(o),children:o};return e.patch(t,n),n}},dt:P,dd:P,del:B,em:q,h1:F,h2:F,h3:F,h4:F,h5:F,h6:F,hr:function(e,t){const n={type:"thematicBreak"};return e.patch(t,n),n},i:q,iframe:function(e,t){const n=t.properties||{},r=String(n.src||""),i=String(n.title||"");if(r&&i){const n={type:"link",title:null,url:e.resolve(r),children:[{type:"text",value:i}]};return e.patch(t,n),n}},img:R,image:R,input:function(e,t){const n=t.properties||{},r=String(n.value||n.placeholder||"");if(n.disabled||"hidden"===n.type||"file"===n.type)return;if("checkbox"===n.type||"radio"===n.type){const r={type:"text",value:n.checked?e.options.checked||"[x]":e.options.unchecked||"[ ]"};return e.patch(t,r),r}if("image"===n.type){const i=n.alt||r;if(i){const r={type:"image",url:e.resolve(String(n.src||"")||null),title:String(n.title||"")||null,alt:String(i)};return e.patch(t,r),r}return}let i=[];if(r)i=[[r,void 0]];else if("button"!==n.type&&"file"!==n.type&&"password"!==n.type&&"reset"!==n.type&&"submit"!==n.type&&n.list){const t=String(n.list),r=e.elementById.get(t);r&&"datalist"===r.tagName&&(i=H(r,n))}if(0===i.length)return;if("password"===n.type&&(i[0]=["•".repeat(i[0][0].length),void 0]),"email"===n.type||"url"===n.type){const t=[];let r=-1;for(;++r<i.length;){const l=e.resolve(i[r][0]),o={type:"link",title:null,url:"email"===n.type?"mailto:"+l:l,children:[{type:"text",value:i[r][1]||l}]};t.push(o),r!==i.length-1&&t.push({type:"text",value:", "})}return t}const l=[];let o=-1;for(;++o<i.length;)l.push(i[o][1]?i[o][1]+" ("+i[o][0]+")":i[o][0]);const a={type:"text",value:l.join(", ")};return e.patch(t,a),a},kbd:z,li:P,listing:I,mark:q,ol:V,p:X,plaintext:I,pre:I,q:function(e,t){const n=e.options.quotes||Z;e.qNesting++;const r=e.all(t);e.qNesting--;const i=n[e.qNesting%n.length],l=r[0],o=r[r.length-1],a=i.charAt(0),c=i.length>1?i.charAt(1):i;return l&&"text"===l.type?l.value=a+l.value:r.unshift({type:"text",value:a}),o&&"text"===o.type?o.value+=c:r.push({type:"text",value:c}),r},s:B,samp:z,select:function(e,t){const n=H(t);let r=-1;const i=[];for(;++r<n.length;){const e=n[r];i.push(e[1]?e[1]+" ("+e[0]+")":e[0])}if(i.length>0){const n={type:"text",value:i.join(", ")};return e.patch(t,n),n}},strike:B,strong:ee,summary:X,table:function(e,t){if(e.inTable){const n={type:"text",value:S(t)};return e.patch(t,n),n}e.inTable=!0;const{align:n,headless:r}=function(e){const t={align:[null],headless:!0};let n=0,r=0;return p(e,(function(i){if("element"===i.type){if("table"===i.tagName&&e!==i)return a;if("th"!==i.tagName&&"td"!==i.tagName||!i.properties)"thead"===i.tagName?t.headless=!1:"tr"===i.tagName&&(n++,r=0);else{if(!t.align[r]){const e=String(i.properties.align||"")||null;"center"!==e&&"left"!==e&&"right"!==e&&null!==e||(t.align[r]=e)}t.headless&&n<2&&"th"===i.tagName&&(t.headless=!1),r++}}})),t}(t),i=e.toSpecificContent(e.all(t),ie);r&&i.unshift({type:"tableRow",children:[]});let l=-1;for(;++l<i.length;){const t=i[l],n=e.toSpecificContent(t.children,re);t.children=n}let o=1;for(l=-1;++l<i.length;){const e=i[l].children;let t=-1;for(;++t<e.length;){const n=e[t];if(n.data){const e=n.data,r=Number.parseInt(String(e.hastUtilToMdastTemporaryColSpan),10)||1,o=Number.parseInt(String(e.hastUtilToMdastTemporaryRowSpan),10)||1;if(r>1||o>1){let e=l-1;for(;++e<l+o;){let n=t-1;for(;++n<t+r&&i[e];){const r=[];e===l&&n===t||r.push({type:"tableCell",children:[]}),i[e].children.splice(n,0,...r)}}}"hastUtilToMdastTemporaryColSpan"in n.data&&delete n.data.hastUtilToMdastTemporaryColSpan,"hastUtilToMdastTemporaryRowSpan"in n.data&&delete n.data.hastUtilToMdastTemporaryRowSpan,0===Object.keys(n.data).length&&delete n.data}}e.length>o&&(o=e.length)}for(l=-1;++l<i.length;){const e=i[l].children;let t=e.length-1;for(;++t<o;)e.push({type:"tableCell",children:[]})}let c=n.length-1;for(;++c<o;)n.push(null);e.inTable=!1;const s={type:"table",align:n,children:i};return e.patch(t,s),s},td:te,textarea:function(e,t){const n={type:"text",value:S(t)};return e.patch(t,n),n},th:te,tr:function(e,t){const n={type:"tableRow",children:e.toSpecificContent(e.all(t),ne)};return e.patch(t,n),n},tt:z,u:q,ul:V,var:z,video:Q,wbr:function(e,t){const n={type:"text",value:"​"};return e.patch(t,n),n},xmp:I};function ae(e,t){return e.all(t)}function ce(e,t){return e.toFlow(e.all(t))}function se(){}const pe={}.hasOwnProperty;function ue(e){const t=e.children||[],n=[];let r=-1;for(;++r<t.length;){const i=t[r],l=this.one(i,e);Array.isArray(l)?n.push(...l):l&&n.push(l)}return n}function he(e,t){if("element"===e.type){if(e.properties&&"ignore"===e.properties.dataMdast)return;if(pe.call(this.handlers,e.tagName))return this.handlers[e.tagName](this,e,t)||void 0}else if(pe.call(this.nodeHandlers,e.type))return this.nodeHandlers[e.type](this,e,t)||void 0;if("value"in e&&"string"==typeof e.value){const t={type:"text",value:e.value};return this.patch(e,t),t}if("children"in e)return this.all(e)}function de(e,n){e.position&&(n.position=t(e))}function fe(e){const t=this.frozenBaseUrl;return null==e?"":t?String(new URL(e,t)):e}function ge(e){return _(e)}function me(e,t){const n=t(),r=[];let i=[],l=-1;for(;++l<e.length;){const t=e[l];if(o(t))i.length>0&&(t.children.unshift(...i),i=[]),r.push(t);else{const e=t;i.push(e)}}if(i.length>0){let e=r[r.length-1];e||(e=t(),r.push(e)),e.children.push(...i),i=[]}return r;function o(e){return e.type===n.type}}const ye={};function be(t,r){const i=e(t),l=r||ye,o=function(e){return function(t){n(t,e)}}({newlines:!0===l.newlines}),a=function(e){return{all:ue,baseFound:!1,elementById:new Map,frozenBaseUrl:void 0,handlers:{...oe,...e.handlers},inTable:!1,nodeHandlers:{...le,...e.nodeHandlers},one:he,options:e,patch:de,qNesting:0,resolve:fe,toFlow:ge,toSpecificContent:me}}(l);let c;o(i),p(i,(function(e){if(e&&"element"===e.type&&e.properties){const t=String(e.properties.id||"")||void 0;t&&!a.elementById.has(t)&&a.elementById.set(t,e)}}));const s=a.one(i,void 0);if(s)if(Array.isArray(s)){c={type:"root",children:s}}else c=s;else c={type:"root",children:[]};return p(c,(function(e,t,n){if("text"===e.type&&void 0!==t&&n){const r=n.children[t-1];if(r&&r.type===e.type)return r.value+=e.value,n.children.splice(t,1),r.position&&e.position&&(r.position.end=e.position.end),t-1;if(e.value=e.value.replace(/[\t ]*(\r?\n|\r)[\t ]*/,"$1"),!n||"heading"!==n.type&&"paragraph"!==n.type&&"root"!==n.type||(t||(e.value=e.value.replace(/^[\t ]+/,"")),t===n.children.length-1&&(e.value=e.value.replace(/[\t ]+$/,""))),!e.value)return n.children.splice(t,1),t}})),c}const ve={document:!0};function xe(e,t){return e&&"run"in e?async function(n,r){const i=be(n,{...ve,...t});await e.run(i,r)}:function(t){return be(t,{...ve,...e})}}export{xe as default};
