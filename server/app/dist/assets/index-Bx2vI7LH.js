import{z as e}from"./index-SYkMgdDi.js";import{f as t,a as n,e as r,p as a,h as c}from"./index-CcOhXizR.js";import{d as o}from"./index-Co4RDjSY.js";import"./index-JhYyEhjv.js";import"./index-xA4LZg4i.js";import"./index-DkGrPSvA.js";import"./index-CWWusv4C.js";import"./index-Ck87fAyN.js";import"./index-Bn4iy8CL.js";const i={}.hasOwnProperty;function s(e,t){let n,r=-1;if(t.extensions)for(;++r<t.extensions.length;)s(e,t.extensions[r]);for(n in t)if(i.call(t,n))switch(n){case"extensions":break;case"unsafe":case"join":h(e[n],t[n]);break;case"handlers":u(e[n],t[n]);break;default:e.options[n]=t[n]}return e}function h(e,t){t&&e.push(...t)}function u(e,t){t&&Object.assign(e,t)}const f=[function(e,r,a,c){if("code"===r.type&&t(r,c)&&("list"===e.type||e.type===r.type&&t(e,c)))return!1;if("spread"in a&&"boolean"==typeof a.spread){if("paragraph"===e.type&&(e.type===r.type||"definition"===r.type||"heading"===r.type&&n(r,c)))return;return a.spread?1:0}}];const l=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],d=[{character:"\t",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"\t",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:"\n",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:l},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:"(?:[\r\n]|$)"},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:l},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:"(?:[ \t\r\n*])"},{character:"*",inConstruct:"phrasing",notInConstruct:l},{atBreak:!0,character:"+",after:"(?:[ \t\r\n])"},{atBreak:!0,character:"-",after:"(?:[ \t\r\n-])"},{atBreak:!0,before:"\\d+",character:".",after:"(?:[ \t\r\n]|$)"},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:l},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:l},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:l},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:l},{atBreak:!0,character:"~"}];function p(e){return e.label||!e.identifier?e.label||"":o(e.identifier)}function g(e){if(!e._compiled){const t=(e.atBreak?"[\\r\\n][\\t ]*":"")+(e.before?"(?:"+e.before+")":"");e._compiled=new RegExp((t?"("+t+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(e.character)?"\\":"")+e.character+(e.after?"(?:"+e.after+")":""),"g")}return e._compiled}function C(e,t,n,r){let a=r.join.length;for(;a--;){const c=r.join[a](e,t,n,r);if(!0===c||1===c)break;if("number"==typeof c)return"\n".repeat(1+c);if(!1===c)return"\n\n\x3c!----\x3e\n\n"}return"\n\n"}const k=/\r?\n|\r/g;function b(e,t){const n=[];let r,a=0,c=0;for(;r=k.exec(e);)o(e.slice(a,r.index)),n.push(r[0]),a=r.index+r[0].length,c++;return o(e.slice(a)),n.join("");function o(e){n.push(t(e,c,!e))}}function x(e,t){return e-t}function m(e,t){const n=/\\(?=[!-/:-@[-`{-~])/g,r=[],a=[],c=e+t;let o,i=-1,s=0;for(;o=n.exec(c);)r.push(o.index);for(;++i<r.length;)s!==r[i]&&a.push(e.slice(s,r[i])),a.push("\\"),s=r[i];return a.push(e.slice(s)),a.join("")}function A(e){const t=e||{},n=t.now||{};let r=t.lineShift||0,a=n.line||1,c=n.column||1;return{move:function(e){const t=e||"",n=t.split(/\r?\n|\r/g),o=n[n.length-1];return a+=n.length-1,c=1===n.length?c+o.length:1+o.length+r,t},current:function(){return{now:{line:a,column:c},lineShift:r}},shift:function(e){r+=e}}}function j(t,n){const r={associationId:p,containerPhrasing:B,containerFlow:L,createTracker:A,compilePattern:g,enter:function(e){return r.stack.push(e),function(){r.stack.pop()}},handlers:{...c},handle:void 0,indentLines:b,indexStack:[],join:[...f],options:{},safe:F,stack:[],unsafe:[...d]};s(r,n||{}),r.options.tightDefinitions&&r.join.push(w),r.handle=e("type",{invalid:y,unknown:v,handlers:r.handlers});let a=r.handle(t,void 0,r,{before:"\n",after:"\n",now:{line:1,column:1},lineShift:0});return a&&10!==a.charCodeAt(a.length-1)&&13!==a.charCodeAt(a.length-1)&&(a+="\n"),a}function y(e){throw new Error("Cannot handle value `"+e+"`, expected node")}function v(e){throw new Error("Cannot handle unknown node `"+e.type+"`")}function w(e,t){if("definition"===e.type&&e.type===t.type)return 0}function B(e,t){return function(e,t,n){const a=t.indexStack,c=e.children||[],o=[];let i,s=-1,h=n.before;a.push(-1);let u=t.createTracker(n);for(;++s<c.length;){const f=c[s];let l;if(a[a.length-1]=s,s+1<c.length){let n=t.handle.handlers[c[s+1].type];n&&n.peek&&(n=n.peek),l=n?n(c[s+1],e,t,{before:"",after:"",...u.current()}).charAt(0):""}else l=n.after;o.length>0&&("\r"===h||"\n"===h)&&"html"===f.type&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),h=" ",u=t.createTracker(n),u.move(o.join("")));let d=t.handle(f,e,t,{...u.current(),after:l,before:h});i&&i===d.slice(0,1)&&(d=r(i.charCodeAt(0))+d.slice(1));const p=t.attentionEncodeSurroundingInfo;t.attentionEncodeSurroundingInfo=void 0,i=void 0,p&&(o.length>0&&p.before&&h===o[o.length-1].slice(-1)&&(o[o.length-1]=o[o.length-1].slice(0,-1)+r(h.charCodeAt(0))),p.after&&(i=l)),u.move(d),o.push(d),h=d.slice(-1)}return a.pop(),o.join("")}(e,this,t)}function L(e,t){return function(e,t,n){const r=t.indexStack,a=e.children||[],c=t.createTracker(n),o=[];let i=-1;for(r.push(-1);++i<a.length;){const n=a[i];r[r.length-1]=i,o.push(c.move(t.handle(n,e,t,{before:"\n",after:"\n",...c.current()}))),"list"!==n.type&&(t.bulletLastUsed=void 0),i<a.length-1&&o.push(c.move(C(n,a[i+1],e,t)))}return r.pop(),o.join("")}(e,this,t)}function F(e,t){return function(e,t,n){const c=(n.before||"")+(t||"")+(n.after||""),o=[],i=[],s={};let h=-1;for(;++h<e.unsafe.length;){const t=e.unsafe[h];if(!a(e.stack,t))continue;const n=e.compilePattern(t);let r;for(;r=n.exec(c);){const e="before"in t||Boolean(t.atBreak),n="after"in t,a=r.index+(e?r[1].length:0);o.includes(a)?(s[a].before&&!e&&(s[a].before=!1),s[a].after&&!n&&(s[a].after=!1)):(o.push(a),s[a]={before:e,after:n})}}o.sort(x);let u=n.before?n.before.length:0;const f=c.length-(n.after?n.after.length:0);for(h=-1;++h<o.length;){const e=o[h];e<u||e>=f||e+1<f&&o[h+1]===e+1&&s[e].after&&!s[e+1].before&&!s[e+1].after||o[h-1]===e-1&&s[e].before&&!s[e-1].before&&!s[e-1].after||(u!==e&&i.push(m(c.slice(u,e),"\\")),u=e,!/[!-/:-@[-`{-~]/.test(c.charAt(e))||n.encode&&n.encode.includes(c.charAt(e))?(i.push(r(c.charCodeAt(e))),u++):i.push("\\"))}return i.push(m(c.slice(u,f),n.after)),i.join("")}(this,e,t)}function I(e){const t=this;t.compiler=function(n){return j(n,{...t.data("settings"),...e,extensions:t.data("toMarkdownExtensions")||[]})}}export{I as default};
