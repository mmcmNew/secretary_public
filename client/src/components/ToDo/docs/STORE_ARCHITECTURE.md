# –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è Redux Store –∏ RTK Query

## üéØ **–ü—Ä–∏–Ω—Ü–∏–ø—ã –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏**

### **1. –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö**
- **RTK Query** = —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ API –¥–∞–Ω–Ω—ã–º–∏ (–∑–∞–≥—Ä—É–∑–∫–∞, –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è)
- **Redux Store** = —Ç–æ–ª—å–∫–æ UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **–ù–ï–¢ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è** –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É RTK Query –∏ Redux

### **2. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**
- **RTK Query** = –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞ (–∑–∞–¥–∞—á–∏, —Å–ø–∏—Å–∫–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏)
- **Redux** = —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (–≤—ã–±—Ä–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã, –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–∞–Ω–µ–ª–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)

### **3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
- RTK Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç Redux store
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö

### **4. –£–º–Ω–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** üÜï
- **WebSocket** = –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞** = –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≤–µ—Ä—Å–∏–∏
- **Fallback –º–µ—Ö–∞–Ω–∏–∑–º** = –µ—Å–ª–∏ WebSocket –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –¥–∞–Ω–Ω—ã–µ –≤—Å–µ —Ä–∞–≤–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è

## üèóÔ∏è **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Store**

### **–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (–ü–†–ê–í–ò–õ–¨–ù–û):**
```javascript
// store/store.js
{
  // ‚úÖ RTK Query API (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö)
  [apiSlice.reducerPath]: apiSlice.reducer,    // –ó–∞–¥–∞—á–∏, —Å–ø–∏—Å–∫–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
  
  // ‚úÖ Redux (—Ç–æ–ª—å–∫–æ UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ + –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
  tasks: tasksSlice,                           // –¢–û–õ–¨–ö–û version –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
  todoLayout: todoLayoutSlice,                 // selectedListId, selectedTaskId
  auth: authSlice,                             // user, isAuthenticated
}
```

### **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```javascript
// store/store.js
export const store = configureStore({
  reducer: {
    // RTK Query API (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö)
    [apiSlice.reducerPath]: apiSlice.reducer,    // –ó–∞–¥–∞—á–∏, —Å–ø–∏—Å–∫–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    
    // Redux (—Ç–æ–ª—å–∫–æ UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ + –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
    tasks: tasksSlice,                           // –¢–û–õ–¨–ö–û version –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
    todoLayout: todoLayoutSlice,                 // selectedListId, selectedTaskId, expandedTasks
    auth: authSlice,                             // user, isAuthenticated, permissions
    ui: uiSlice,                                 // theme, sidebarCollapsed, notifications
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(apiSlice.middleware),
});
```

## üîÑ **–°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**

### **1. –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**

```javascript
// ‚úÖ WebSocket: –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
socket.on('data_updated', (data) => {
  if (data.tasksVersion > currentTasksVersion) {
    dispatch(setTasksVersion(data.tasksVersion));
    dispatch(tasksApi.util.invalidateTags(['Task']));
  }
});

// ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞: –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
getTasks: builder.query({
  query: (listId) => `/api/tasks/get_tasks?list_id=${listId}`,
  async onQueryStarted(_, { dispatch, queryFulfilled, getState }) {
    const { data } = await queryFulfilled;
    // ‚úÖ –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º –≤–µ—Ä—Å–∏–∏ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –∫–ª–∏–µ–Ω—Ç–∞
    if (data.version !== getState().tasks.version) {
      console.log(`üîÑ –í–µ—Ä—Å–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞: ${getState().tasks.version} ‚Üí ${data.version}`);
      dispatch(setTasksVersion(data.version));
      dispatch(tasksApi.util.invalidateTags(['Task']));
    }
  },
})
```

### **2. –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**

```javascript
// 1. –ö–ª–∏–µ–Ω—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ
const { data: tasks } = useGetTasksQuery(selectedListId);

// 2. RTK Query –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä
GET /api/tasks/get_tasks?list_id=123

// 3. –°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ + –≤–µ—Ä—Å–∏—é
{
  "tasks": [...],
  "version": 42  // ‚úÖ –í–µ—Ä—Å–∏—è –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
}

// 4. RTK Query —Å—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –≤–µ—Ä—Å–∏–∏
if (serverVersion !== clientVersion) {
  // ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é –≤–µ—Ä—Å–∏—é
  dispatch(setTasksVersion(serverVersion));
  // ‚úÖ –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –∫—ç—à –¥–ª—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
  dispatch(tasksApi.util.invalidateTags(['Task']));
}

// 5. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
```

### **3. –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –¥–≤–æ–π–Ω–æ–π –∑–∞—â–∏—Ç—ã**

- ‚úÖ **WebSocket —Ä–∞–±–æ—Ç–∞–µ—Ç** = –º–≥–Ω–æ–≤–µ–Ω–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- ‚úÖ **WebSocket –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç** = –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö
- ‚úÖ **–ù–µ—Ç –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤** = –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö
- ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ** = –µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ —É—Å—Ç–∞—Ä–µ–ª–∏

## üîß **–≠—Ç–∞–ø—ã —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ Store**

### **–≠—Ç–∞–ø 1: –£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ slice** ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
```javascript
// ‚ùå –£–ë–†–ê–ù–û: –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ tasksSlice
// ‚úÖ –û–°–¢–ê–í–õ–ï–ù–û: —Ç–æ–ª—å–∫–æ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
export const tasksSlice = createSlice({
  name: 'tasks',
  initialState: {
    version: 0,  // ‚úÖ –¢–û–õ–¨–ö–û –≤–µ—Ä—Å–∏—è –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
  },
  reducers: {
    setTasksVersion: (state, action) => {
      state.version = action.payload;
    },
  },
});
```

### **–≠—Ç–∞–ø 2: –£–ø—Ä–æ—Å—Ç–∏—Ç—å todoLayoutSlice**
```javascript
// todoLayoutSlice.js - –¢–û–õ–¨–ö–û UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ
const initialState = {
  // ‚úÖ –¢–û–õ–¨–ö–û ID –∏ UI —Ñ–ª–∞–≥–∏
  selectedListId: null,
  selectedTaskId: null,
  expandedTasks: {},
  openGroups: {},
  contextTarget: { id: null, menuType: null },
  
  // ‚ùå –ù–ï —Ö—Ä–∞–Ω–∏–º –æ–±—ä–µ–∫—Ç—ã
  // selectedList: null,     // –£–ë–†–ê–¢–¨!
  // selectedTask: null,     // –£–ë–†–ê–¢–¨!
};
```

### **–≠—Ç–∞–ø 3: –û–±–Ω–æ–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**
```javascript
// ToDoTasksPanel.jsx
function ToDoTasksPanel() {
  const { selectedListId } = useSelector((state) => state.todoLayout);
  
  // ‚úÖ –ï–î–ò–ù–´–ô –ò–°–¢–û–ß–ù–ò–ö: RTK Query
  const { data: tasks = [] } = useGetTasksQuery(selectedListId, {
    skip: !selectedListId,
  });
  
  // ‚úÖ –ü–û–õ–£–ß–ê–ï–ú selectedList –ø–æ ID
  const { data: listsData } = useGetListsQuery();
  const selectedList = useMemo(() => {
    if (!selectedListId || !listsData) return null;
    return listsData.lists.find(l => l.id === selectedListId) || 
           listsData.default_lists.find(l => l.id === selectedListId);
  }, [selectedListId, listsData]);
  
  return <TasksList tasks={tasks} selectedList={selectedList} />;
}
```

## üìä **–ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö**

### **1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
```
1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç useGetTasksQuery(selectedListId)
2. RTK Query –¥–µ–ª–∞–µ—Ç API –∑–∞–ø—Ä–æ—Å
3. RTK Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç store[apiSlice.reducerPath]
4. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å useGetTasksQuery –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
5. ‚úÖ –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ê–Ø –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
```

### **2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:**
```
1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç updateTask mutation
2. RTK Query –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç API –∑–∞–ø—Ä–æ—Å
3. RTK Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç store[apiSlice.reducerPath]
4. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å useGetTasksQuery –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
```

### **3. UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
```
1. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –≤—ã–∑—ã–≤–∞–µ—Ç setSelectedListId(123)
2. Redux –æ–±–Ω–æ–≤–ª—è–µ—Ç state.todoLayout.selectedListId
3. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å useSelector –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
4. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–æ–ª—É—á–∞—é—Ç –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ RTK Query
```

### **4. –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–µ—Ä—Å–∏–π:** üÜï
```
1. WebSocket –ø–æ–ª—É—á–∞–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–∏
2. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è state.tasks.version
3. –ò–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è –∫—ç—à –∑–∞–¥–∞—á
4. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è —Å –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
5. ‚úÖ Fallback: –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º –∑–∞–ø—Ä–æ—Å–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è
```

## üéØ **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã**

### **1. –ù–µ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ RTK Query
- Redux —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ + –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

### **2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**
- RTK Query –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç store
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è

### **3. –£–º–Ω–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** üÜï
- WebSocket –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

### **4. –ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏**
- –û–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è API
- –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- –ü–æ–Ω—è—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### **5. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
- RTK Query –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –∫–µ—à–∞
- –ù–µ—Ç –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

## üö® **–ß—Ç–æ –ù–ï –¥–µ–ª–∞—Ç—å**

### **‚ùå –ù–ï –¥—É–±–ª–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ:**
```javascript
// ‚ùå –ü–õ–û–•–û: –¥–∞–Ω–Ω—ã–µ –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö
const tasks = useSelector((state) => state.tasks.byId);
const { data: tasks } = useGetTasksQuery(selectedListId);

// ‚úÖ –•–û–†–û–®–û: —Ç–æ–ª—å–∫–æ RTK Query
const { data: tasks = [] } = useGetTasksQuery(selectedListId);
```

### **‚ùå –ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ –æ–±—ä–µ–∫—Ç—ã –≤ UI slice:**
```javascript
// ‚ùå –ü–õ–û–•–û: –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤
{
  selectedListId: 123,
  selectedList: { id: 123, title: "–ú–æ–π —Å–ø–∏—Å–æ–∫", ... } // –£–ë–†–ê–¢–¨!
}

// ‚úÖ –•–û–†–û–®–û: —Ç–æ–ª—å–∫–æ ID
{
  selectedListId: 123,
  // selectedList —É–±—Ä–∞–Ω!
}
```

### **‚ùå –ù–ï –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ store –Ω–∞–ø—Ä—è–º—É—é:**
```javascript
// ‚ùå –ü–õ–û–•–û: –ø—Ä—è–º–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ store
const task = useSelector((state) => state.tasks.byId[selectedTaskId]);

// ‚úÖ –•–û–†–û–®–û: —á–µ—Ä–µ–∑ RTK Query
const { data: tasks } = useGetTasksQuery(selectedListId);
const task = tasks.find(t => t.id === selectedTaskId);
```

### **‚ùå –ù–ï –∏–≥–Ω–æ—Ä–∏—Ä—É–π—Ç–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:** üÜï
```javascript
// ‚ùå –ü–õ–û–•–û: —Ç–æ–ª—å–∫–æ WebSocket
socket.on('data_updated', () => {
  dispatch(tasksApi.util.invalidateTags(['Task']));
});

// ‚úÖ –•–û–†–û–®–û: –¥–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞
// 1. WebSocket –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
// 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–∏ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–∞—Ö
```

## üîÑ **–ü–æ—Ä—è–¥–æ–∫ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏**

1. ‚úÖ **–£–±—Ä–∞—Ç—å –¥—É–±–ª–∏—Ä—É—é—â–∏–µ slice** - –í–´–ü–û–õ–ù–ï–ù–û
2. **–£–ø—Ä–æ—Å—Ç–∏—Ç—å** `todoLayoutSlice` (—Ç–æ–ª—å–∫–æ UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
3. **–û–±–Ω–æ–≤–∏—Ç—å** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è RTK Query
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å** —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö
5. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## üìù **–ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞**

```javascript
// store/store.js
export const store = configureStore({
  reducer: {
    // RTK Query API (–µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö)
    [apiSlice.reducerPath]: apiSlice.reducer,    // –ó–∞–¥–∞—á–∏, —Å–ø–∏—Å–∫–∏, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
    
    // Redux (—Ç–æ–ª—å–∫–æ UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ + –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ)
    tasks: tasksSlice,                           // –¢–û–õ–¨–ö–û version –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç–∏
    todoLayout: todoLayoutSlice,                 // selectedListId, selectedTaskId, expandedTasks
    auth: authSlice,                             // user, isAuthenticated, permissions
    ui: uiSlice,                                 // theme, sidebarCollapsed, notifications
  },
  middleware: (getDefaultMiddleware) =>
    getDefaultMiddleware().concat(apiSlice.middleware),
});
```

## üéâ **–†–µ–∑—É–ª—å—Ç–∞—Ç**

–ü–æ—Å–ª–µ —Ä–µ–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ —É –≤–∞—Å –±—É–¥–µ—Ç:
- ‚úÖ –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –¥–∞–Ω–Ω—ã—Ö (RTK Query)
- ‚úÖ –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
- ‚úÖ –£–º–Ω–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –¥–≤–æ–π–Ω–æ–π –∑–∞—â–∏—Ç–æ–π üÜï
- ‚úÖ –ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ—Ç–ª–∞–¥–∫–∏ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- ‚úÖ –ù–ï–¢ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ üÜï
