# ToDoLayoutUniversal - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

## üèóÔ∏è –û–±—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
ToDoLayoutUniversal (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä)
‚îú‚îÄ‚îÄ ToDoListsPanel (—Å–ø–∏—Å–∫–∏)
‚îú‚îÄ‚îÄ ToDoTasksPanel (–∑–∞–¥–∞—á–∏) 
|   ‚îî‚îÄ‚îÄ TasksList (—Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á)
‚îî‚îÄ‚îÄ ToDoTaskEditorPanel (—Ä–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–¥–∞—á–∏)
    ‚îî‚îÄ‚îÄ TaskEditor (—Ä–µ–¥–∞–∫—Ç–æ—Ä –∑–∞–¥–∞—á–∏)
```

## üìä –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö (Store)

### 1. **tasksSlice** - –ï–î–ò–ù–°–¢–í–ï–ù–ù–´–ô –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã –¥–ª—è –í–°–ï–• –∑–∞–¥–∞—á
```javascript
{
  byId: {},           // –í–°–ï –∑–∞–¥–∞—á–∏ –ø–æ ID (–≤–∫–ª—é—á–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∏!)
  allIds: [],         // –í—Å–µ ID –∑–∞–¥–∞—á
  selectedTaskId: null,
  loading: false,
  error: null,
  version: 0
}
```

**–í–∞–∂–Ω–æ**: –ü–æ–¥–∑–∞–¥–∞—á–∏ - —ç—Ç–æ –æ–±—ã—á–Ω—ã–µ –∑–∞–¥–∞—á–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∑–∞–¥–∞—á–µ–π —á–µ—Ä–µ–∑ `parent_id` –∏–ª–∏ `childes_order`. –ù–ï –Ω—É–∂–µ–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π store –¥–ª—è –ø–æ–¥–∑–∞–¥–∞—á!

### 2. **todoLayoutSlice** - UI —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–¢–û–õ–¨–ö–û ID!)
```javascript
{
  selectedListId: null,    // –í—ã–±—Ä–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ (ID)
  selectedTaskId: null,    // –í—ã–±—Ä–∞–Ω–Ω–∞—è –∑–∞–¥–∞—á–∞ (ID)
  expandedTasks: {},       // –†–∞—Å–∫—Ä—ã—Ç—ã–µ –∑–∞–¥–∞—á–∏
  openGroups: {}           // –û—Ç–∫—Ä—ã—Ç—ã–µ –≥—Ä—É–ø–ø—ã
  // ‚ùå –ù–ï —Ö—Ä–∞–Ω–∏–º –æ–±—ä–µ–∫—Ç—ã selectedList –∏ selectedTask!
}
```

### 3. **RTK Query API** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏
- `useGetTasksQuery(listId)` - –∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á —Å–ø–∏—Å–∫–∞
- `useGetTasksByIds([id1, id2, ...])` - –¥–æ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∑–∞–¥–∞—á (–≤–∫–ª—é—á–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∏)
- `useUpdateTaskMutation` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –í–°–ï–• –∑–∞–¥–∞—á)
- `useChangeTaskStatusMutation` - –∏–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ (—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è –í–°–ï–• –∑–∞–¥–∞—á)
- `useAddSubtaskMutation` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏ (—Å–æ–∑–¥–∞–µ—Ç –æ–±—ã—á–Ω—É—é –∑–∞–¥–∞—á—É)
- `useDeleteTaskMutation` - —É–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏

## üîÑ –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### **–ü–æ—Ç–æ–∫ 1: –°–ø–∏—Å–∫–∏ ‚Üí –ó–∞–¥–∞—á–∏**

```
1. ToDoListsPanel
   ‚Üì (dispatch setSelectedListId)
2. todoLayoutSlice (selectedListId)
   ‚Üì (useSelector)
3. ToDoTasksPanel
   ‚Üì (useGetTasksQuery(selectedListId))
4. RTK Query ‚Üí Store (tasks.byId)
   ‚Üì (useSelector tasks.byId)
5. ToDoTasksPanel –ø–æ–ª—É—á–∞–µ—Ç tasks
   ‚Üì (props tasks)
6. TasksList –ø–æ–ª—É—á–∞–µ—Ç tasks —á–µ—Ä–µ–∑ props
```

### **–ü–æ—Ç–æ–∫ 2: –í—ã–±–æ—Ä –∑–∞–¥–∞—á–∏ ‚Üí –†–µ–¥–∞–∫—Ç–æ—Ä**

```
1. TasksList (–∫–ª–∏–∫ –ø–æ –∑–∞–¥–∞—á–µ)
   ‚Üì (dispatch setSelectedTaskId)
2. todoLayoutSlice (selectedTaskId)
   ‚Üì (useSelector)
3. ToDoTaskEditorPanel
   ‚Üì (useGetTasksQuery(selectedListId) ‚Üí tasks.find)
4. –ü–æ–ª—É—á–∞–µ—Ç task –æ–±—ä–µ–∫—Ç
   ‚Üì (props task)
5. TaskEditor –ø–æ–ª—É—á–∞–µ—Ç task —á–µ—Ä–µ–∑ props
```

### **–ü–æ—Ç–æ–∫ 3: –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–¥–∑–∞–¥–∞—á (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è)**

```
1. TaskEditor –ø–æ–ª—É—á–∞–µ—Ç task —Å childes_order
   ‚Üì (–ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –ø–æ–¥–∑–∞–¥–∞—á –≤ store)
2. –ï—Å–ª–∏ –ø–æ–¥–∑–∞–¥–∞—á –Ω–µ—Ç ‚Üí useGetTasksByIds(missingIds)
   ‚Üì (API –∑–∞–ø—Ä–æ—Å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –∑–∞–¥–∞—á)
3. RTK Query ‚Üí Store (tasks.byId) - –ø–æ–¥–∑–∞–¥–∞—á–∏ –¥–æ–±–∞–≤–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   ‚Üì (–≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è)
```

### **–ü–æ—Ç–æ–∫ 4: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ UI**

```
1. TaskEditor (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª—è)
   ‚Üì (onChange callback)
2. ToDoTaskEditorPanel.handleTaskEditorChange
   ‚Üì (updateTask mutation)
3. RTK Query API call
   ‚Üì (–æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞)
4. Store –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ extraReducers
   ‚Üì (tasks.byId –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è)
5. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å useSelector –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
```

## üéØ –†–æ–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### **ToDoLayoutUniversal** - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–æ—Ä
- **–ó–∞–¥–∞—á–∞**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –ø–æ–∫–∞–∑–∞ (—Å–ø–∏—Å–∫–∏/–∑–∞–¥–∞—á–∏/—Ä–µ–¥–∞–∫—Ç–æ—Ä)
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: `useSelector(state => state.todoLayout)` (—Ç–æ–ª—å–∫–æ ID!)
- **–î–µ–π—Å—Ç–≤–∏—è**: –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –ø–∞–Ω–µ–ª—è–º–∏
- **–î–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: ToDoListsPanel, ToDoTasksPanel, ToDoTaskEditorPanel

### **ToDoListsPanel** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞–º–∏
- **–ó–∞–¥–∞—á–∞**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞–º–∏/–≥—Ä—É–ø–ø–∞–º–∏/–ø—Ä–æ–µ–∫—Ç–∞–º–∏
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: `useGetListsQuery()`, `useSelector(state => state.todoLayout.selectedListId)`
- **–î–µ–π—Å—Ç–≤–∏—è**: 
  - –í—ã–±–æ—Ä —Å–ø–∏—Å–∫–∞ (`setSelectedListId`)
  - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å–æ —Å–ø–∏—Å–∫–∞–º–∏
- **–î–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: ListsList

### **ToDoTasksPanel** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∞–º–∏
- **–ó–∞–¥–∞—á–∞**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: `useGetTasksQuery(selectedListId)`, `useSelector(state => state.todoLayout.selectedListId)`
- **–î–µ–π—Å—Ç–≤–∏—è**:
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
  - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Å–ø–∏—Å–∫–∞
- **–î–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: TasksList
- **–ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö**: `tasks` ‚Üí TasksList —á–µ—Ä–µ–∑ props

### **ToDoTaskEditorPanel** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–¥–∞–∫—Ç–æ—Ä–æ–º
- **–ó–∞–¥–∞—á–∞**: –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∑–∞–¥–∞—á–∏
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: `useGetTasksQuery(selectedListId)` ‚Üí `tasks.find(selectedTaskId)`
- **–î–µ–π—Å—Ç–≤–∏—è**:
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç TaskEditor
  - –í—ã–∑–æ–≤ API –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–æ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–¥–∑–∞–¥–∞—á
- **–î–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: TaskEditor
- **–ü–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö**: `task`, `subtasks`, `taskFields` ‚Üí TaskEditor —á–µ—Ä–µ–∑ props

### **TasksList** - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∑–∞–¥–∞—á (–ü–ï–†–ï–ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ô)
- **–ó–∞–¥–∞—á–∞**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∑–∞–¥–∞—á —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–∏
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ props –æ—Ç ToDoTasksPanel
- **–ù–ï –î–û–õ–ñ–ï–ù**: –û–±—Ä–∞—â–∞—Ç—å—Å—è –∫ store –Ω–∞–ø—Ä—è–º—É—é
- **–î–µ–π—Å—Ç–≤–∏—è**: –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤, drag&drop, –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–æ–µ –º–µ–Ω—é
- **–î–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: TaskRow, CompletedTasksSection

### **TaskEditor** - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏ (–ü–ï–†–ï–ò–°–ü–û–õ–¨–ó–£–ï–ú–´–ô)
- **–ó–∞–¥–∞—á–∞**: –§–æ—Ä–º–∞ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏ –ø–æ–¥–∑–∞–¥–∞—á
- **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**: –¢–û–õ–¨–ö–û —á–µ—Ä–µ–∑ props –æ—Ç ToDoTaskEditorPanel
- **–ù–ï –î–û–õ–ñ–ï–ù**: –û–±—Ä–∞—â–∞—Ç—å—Å—è –∫ store –Ω–∞–ø—Ä—è–º—É—é
- **–î–µ–π—Å—Ç–≤–∏—è**: –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–µ–π, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∞–º–∏
- **–î–æ—á–µ—Ä–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: TaskTitleSection, TaskFieldsSection

## ‚ö†Ô∏è –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### **–ü—Ä–æ–±–ª–µ–º–∞ 1: –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∏—Å—Ç–∏–Ω—ã**
```javascript
// ‚ùå –ü–õ–û–•–û: TasksList –ø–æ–ª—É—á–∞–µ—Ç tasks —á–µ—Ä–µ–∑ props
<TasksList tasks={tasks} />

// ‚ùå –ü–õ–û–•–û: TaskEditor –ø–æ–ª—É—á–∞–µ—Ç task –Ω–∞–ø—Ä—è–º—É—é –∏–∑ store
const task = useSelector((state) => state.tasks.byId[selectedTaskId]);
```

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```javascript
// ‚úÖ –•–û–†–û–®–û: –í—Å–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ props
<TasksList tasks={tasks} />
<TaskEditor task={task} subtasks={subtasks} />
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö**
- `ToDoTasksPanel` –ø–æ–ª—É—á–∞–µ—Ç `tasks` –∏–∑ `useGetTasksQuery`
- `ToDoTaskEditorPanel` –ø–æ–ª—É—á–∞–µ—Ç `task` –∏–∑ `useSelector(state.tasks.byId)`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í–æ–∑–º–æ–∂–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –≤ –¥–∞–Ω–Ω—ã—Ö

### **–ü—Ä–æ–±–ª–µ–º–∞ 3: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ todoLayoutSlice**
- `todoLayoutSlice` —Ö—Ä–∞–Ω–∏—Ç `selectedList` –∏ `selectedTask` –æ–±—ä–µ–∫—Ç—ã
- –ù–æ —ç—Ç–∏ –æ–±—ä–µ–∫—Ç—ã —É–∂–µ –µ—Å—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö store
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è

### **–ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥–∑–∞–¥–∞—á** üö® –ö–†–ò–¢–ò–ß–ù–û
- –ü–æ–¥–∑–∞–¥–∞—á–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `useGetSubtasksQuery` ‚ùå
- –ü–æ–¥–∑–∞–¥–∞—á–∏ –ù–ï –ø–æ–ø–∞–¥–∞—é—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–π `tasks.byId` store ‚ùå
- **–ü—Ä–æ–±–ª–µ–º–∞**: –ü–æ–¥–∑–∞–¥–∞—á–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç –≤ –¥–≤—É—Ö –º–µ—Å—Ç–∞—Ö, –≤–æ–∑–º–æ–∂–Ω—ã —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:**
```javascript
// ‚úÖ –•–û–†–û–®–û: –í—Å–µ –∑–∞–¥–∞—á–∏ (–≤–∫–ª—é—á–∞—è –ø–æ–¥–∑–∞–¥–∞—á–∏) –≤ tasks.byId
const { data: tasks = [] } = useGetTasksQuery(selectedListId);

// –ü–æ–ª—É—á–∞–µ–º –ø–æ–¥–∑–∞–¥–∞—á–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ store
const subtasks = useMemo(() => {
  if (!task?.childes_order) return [];
  return task.childes_order
    .map(id => tasks.find(t => t.id === id))
    .filter(Boolean);
}, [task?.childes_order, tasks]);

// –î–æ–∑–∞–≥—Ä—É–∂–∞–µ–º –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –ø–æ–¥–∑–∞–¥–∞—á–∏
useEffect(() => {
  if (task?.childes_order && tasks.length > 0) {
    const missingSubtasks = task.childes_order.filter(id => 
      !tasks.find(t => t.id === id)
    );
    if (missingSubtasks.length > 0) {
      getTasksByIds(missingSubtasks); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –≤ tasks.byId
    }
  }
}, [task?.childes_order, tasks, getTasksByIds]);
```

### **–ü—Ä–æ–±–ª–µ–º–∞ 5: –†–∞–∑—Ä—ã–≤ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏**
- `TaskEditor` –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–¥–∞—á—É ‚Üí API –æ–±–Ω–æ–≤–ª—è–µ—Ç store
- –ù–æ `TasksList` –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ props, –∞ –Ω–µ –∏–∑ store
- **–†–µ–∑—É–ª—å—Ç–∞—Ç**: `TasksList` –≤–∏–¥–∏—Ç —Å—Ç–∞—Ä—ã–µ –¥–∞–Ω–Ω—ã–µ

### **–ü—Ä–æ–±–ª–µ–º–∞ 6: –õ–∏—à–Ω–∏–µ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä—ã**
- –ü–µ—Ä–µ–¥–∞—á–∞ –Ω–æ–≤—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —á–µ—Ä–µ–∑ props –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å –ª–∏—à–Ω–∏–µ —Ä–µ–Ω–¥–µ—Ä—ã
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Å `useMemo`, `React.memo`, `useCallback`

## üîß –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### **–≠—Ç–∞–ø 1: –£–±—Ä–∞—Ç—å –ø—Ä—è–º—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è –∫ store**
- `TaskEditor` –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∞—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ props
- `TasksList` —É–∂–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ props (—Ö–æ—Ä–æ—à–æ)

### **–≠—Ç–∞–ø 2: –û—á–∏—Å—Ç–∏—Ç—å todoLayoutSlice**
- –£–±—Ä–∞—Ç—å `selectedList` –∏ `selectedTask` –æ–±—ä–µ–∫—Ç—ã
- –û—Å—Ç–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ ID (`selectedListId`, `selectedTaskId`)
- –ü–æ–ª—É—á–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –ø–æ ID –∏–∑ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö store

### **–≠—Ç–∞–ø 3: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**
- `ToDoTaskEditorPanel` –¥–æ–ª–∂–µ–Ω –ø–æ–ª—É—á–∞—Ç—å `task` –∏–∑ —Ç–æ–≥–æ –∂–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∞, —á—Ç–æ –∏ `ToDoTasksPanel`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useGetTasksQuery` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∞–∫—Ç—É–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### **–≠—Ç–∞–ø 4: –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –ø–æ–¥–∑–∞–¥–∞—á** üö® –ü–†–ò–û–†–ò–¢–ï–¢
- **–£–ë–†–ê–¢–¨** `useGetSubtasksQuery` –ø–æ–ª–Ω–æ—Å—Ç—å—é
- **–ò–°–ü–û–õ–¨–ó–û–í–ê–¢–¨** `useGetTasksByIds` –¥–ª—è –¥–æ–∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–¥–∑–∞–¥–∞—á
- **–í–°–ï –ø–æ–¥–∑–∞–¥–∞—á–∏** –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ `tasks.byId`
- **–ü–æ–¥–∑–∞–¥–∞—á–∏** - —ç—Ç–æ –æ–±—ã—á–Ω—ã–µ –∑–∞–¥–∞—á–∏, –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —á–µ—Ä–µ–∑ `updateTask`

### **–≠—Ç–∞–ø 5: –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useMemo` –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤ –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
- –î–æ–±–∞–≤–∏—Ç—å `React.memo` –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useCallback` –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π

### **–≠—Ç–∞–ø 6: –û–±–µ—Å–ø–µ—á–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é**
- –ü–æ—Å–ª–µ API –≤—ã–∑–æ–≤–æ–≤ –¥–∞–Ω–Ω—ã–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ store
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å `useSelector` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å props –ø–æ–ª—É—á–∞—é—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è

## üìã –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –¥–ª—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

1. **–ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã**: Store `tasks.byId` –¥–ª—è –í–°–ï–• –∑–∞–¥–∞—á
2. **–ü–æ–¥–∑–∞–¥–∞—á–∏ = –æ–±—ã—á–Ω—ã–µ –∑–∞–¥–∞—á–∏**: –ù–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ store, –Ω–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ API
3. **–ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö —Å–≤–µ—Ä—Ö—É –≤–Ω–∏–∑**: Store ‚Üí –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–ø—Ä–æ–∫–ª–∞–¥–∫–∏ ‚Üí –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. **–ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã**: –ù–ï –æ–±—Ä–∞—â–∞—é—Ç—Å—è –∫ store, –ø–æ–ª—É—á–∞—é—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ props
5. **–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–ø—Ä–æ–∫–ª–∞–¥–∫–∏**: –ü–æ–ª—É—á–∞—é—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ store –∏ –ø–µ—Ä–µ–¥–∞—é—Ç –≤–Ω–∏–∑
6. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: RTK Query –æ–±–Ω–æ–≤–ª—è–µ—Ç store, –≤—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–≤–∞—é—Ç—Å—è
7. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `useMemo`, `React.memo`, `useCallback`
8. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è**: –í store —Ö—Ä–∞–Ω–∏–º —Ç–æ–ª—å–∫–æ ID, –æ–±—ä–µ–∫—Ç—ã –ø–æ–ª—É—á–∞–µ–º –ø–æ ID

## üîç –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### **–õ–æ–≥–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Ç–æ–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö:**
```javascript
// –í ToDoTasksPanel
console.log('ToDoTasksPanel tasks:', tasks);

// –í ToDoTaskEditorPanel  
console.log('ToDoTaskEditorPanel task:', task);

// –í TasksList
console.log('TasksList received tasks:', tasks);

// –í TaskEditor
console.log('TaskEditor received task:', task);
```

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:**
1. –ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É –≤ TaskEditor
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ store –æ–±–Ω–æ–≤–∏–ª—Å—è
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ TasksList –ø–æ–ª—É—á–∏–ª –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ UI –æ–±–Ω–æ–≤–∏–ª—Å—è –≤–µ–∑–¥–µ

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:**
1. –û—Ç–∫—Ä—ã—Ç—å React DevTools Profiler
2. –ò–∑–º–µ–Ω–∏—Ç—å –∑–∞–¥–∞—á—É
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –Ω—É–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
4. –£–±–µ–¥–∏—Ç—å—Å—è –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –ª–∏—à–Ω–∏—Ö —Ä–µ–Ω–¥–µ—Ä–æ–≤

### **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∑–∞–¥–∞—á:**
1. –û—Ç–∫—Ä—ã—Ç—å –∑–∞–¥–∞—á—É —Å –ø–æ–¥–∑–∞–¥–∞—á–∞–º–∏
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ø–æ–¥–∑–∞–¥–∞—á–∏ –∑–∞–≥—Ä—É–∑–∏–ª–∏—Å—å –≤ `tasks.byId`
3. –ò–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥–∑–∞–¥–∞—á—É
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å —á–µ—Ä–µ–∑ `updateTask`
5. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –ø–æ–¥–∑–∞–¥–∞—á–∏ –æ–±–Ω–æ–≤–∏–ª–∏—Å—å –≤–µ–∑–¥–µ

## üöÄ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

### **useMemo –¥–ª—è –æ–±—ä–µ–∫—Ç–æ–≤:**
```javascript
const memoizedTask = useMemo(() => task, [task?.id, task?.version]);
const memoizedSubtasks = useMemo(() => subtasks, [
  subtasks?.length, 
  subtasks?.map(s => s.id + s.version).join(',')
]);
```

### **React.memo –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:**
```javascript
const TaskEditor = React.memo(({ task, subtasks, ... }) => {
  // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç
}, (prevProps, nextProps) => {
  return (
    prevProps.task?.id === nextProps.task?.id &&
    prevProps.task?.version === nextProps.task?.version &&
    prevProps.subtasks?.length === nextProps.subtasks?.length
  );
});
```

### **useCallback –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π:**
```javascript
const handleTaskChange = useCallback((updatedTask) => {
  // –õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
}, [updateTask]);
```

## üéØ **–ö–ª—é—á–µ–≤–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –ø–æ–¥–∑–∞–¥–∞—á**

```javascript
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û: –û—Ç–¥–µ–ª—å–Ω—ã–π API –¥–ª—è –ø–æ–¥–∑–∞–¥–∞—á
const { data: subtasks = [] } = useGetSubtasksQuery(selectedTaskId);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –ü–æ–¥–∑–∞–¥–∞—á–∏ –∏–∑ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ store
const subtasks = useMemo(() => {
  if (!task?.childes_order) return [];
  return task.childes_order
    .map(id => tasks.find(t => t.id === id))
    .filter(Boolean);
}, [task?.childes_order, tasks]);

// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û: –î–æ–∑–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø–æ–¥–∑–∞–¥–∞—á
const [getTasksByIds] = useLazyGetTasksByIdsQuery();
useEffect(() => {
  if (task?.childes_order && tasks.length > 0) {
    const missingSubtasks = task.childes_order.filter(id => 
      !tasks.find(t => t.id === id)
    );
    if (missingSubtasks.length > 0) {
      getTasksByIds(missingSubtasks); // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ tasks.byId
    }
  }
}, [task?.childes_order, tasks, getTasksByIds]);
```
